<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Cabinet Quote</title>
    <link rel="stylesheet" href="styles.css"/>
  </head>
  <body>
    <div class="wrap grid-2col">
      <!-- Left side: selection and picking controls -->
      <div class="left-panel">
        <section class="panel">
          <!-- Job name field at the top -->
          <div class="row" style="margin-bottom:18px;">
            <label for="jobNameInput">Job name</label>
            <input id="jobNameInput" type="text" placeholder="Enter job name..." style="width:180px"/>
          </div>

          <div class="row">
            <label for="categorySelect">Category</label>
            <select id="categorySelect"></select>
          </div>
          <div class="row">
            <label for="colorSelect">Color</label>
            <select id="colorSelect"></select>
          </div>

          <!-- New: color apply controls -->
          <div class="row">
            <label class="hstack" style="gap:8px;">
              <input type="checkbox" id="syncColorCatChk" />
              Auto-apply selected color to all items in this category
            </label>
            <button id="applyColorNowBtn" class="btn ghost" style="margin-left:auto;">Apply now</button>
          </div>

          <div class="row">
            <label for="codeInput">Add item by code</label>
            <div class="hstack">
              <input id="codeInput" placeholder="ex W1830" />
              <input id="qtyInput" type="number" min="1" value="1" style="width:90px"/>
              <button id="addBtn" class="btn">Add</button>
            </div>
            <small id="codeHelp" class="muted">
              Enter key adds item by code.
            </small>
          </div>

          <!-- New: apply selected color to this code in cart -->
          <div class="row">
            <button id="applyColorToCodeBtn" class="btn ghost">Apply selected color to this code in cart</button>
          </div>

          <div class="row">
            <details>
              <summary>Find items</summary>
              <div id="results" class="results"></div>
            </details>
          </div>
        </section>
      </div>

      <!-- Right side: picked items, tax, total etc -->
      <div class="right-panel">
        <section class="panel">
          <table id="itemsTable">
            <thead>
              <tr>
                <th>Code</th>
                <th>Unit</th>
                <th>Qty</th>
                <th>Total</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="cart-body"></tbody>
          </table>
          <div class="tableActions">
            <button id="clearBtn" class="btn ghost">Clear all</button>
          </div>
        </section>

        <section class="panel">
          <h3>Tax</h3>
          <div class="row">
            <label for="locationSelect">State</label>
            <select id="locationSelect"></select>
          </div>
          <div class="row">
            <label>
              <input type="checkbox" id="noTaxChk" />
              No tax
            </label>
          </div>
        </section>

        <section class="panel totals">
          <div class="line">
            <span>Subtotal</span>
            <span id="subTotalTxt">$0.00</span>
          </div>
          <div class="line">
            <span>Discount</span>
            <span id="discountTxt">50%</span>
          </div>
          <div class="line">
            <span>After discount</span>
            <span id="afterDiscountTxt">$0.00</span>
          </div>
          <div class="line">
            <span>Tax</span>
            <span id="taxRateTxt">0.00%</span>
          </div>
          <div class="line grand">
            <span>Grand total</span>
            <span id="grandTotalTxt">$0.00</span>
          </div>
        </section>

        <!-- Export buttons section -->
        <section class="panel">
          <div id="exportButtons" style="margin-top:12px;">
            <button id="exportTextBtn" class="btn">Export as Text</button>
            <button id="exportWordBtn" class="btn">Export as Word</button>
            <button id="exportPdfBtn" class="btn">Export as PDF</button>
          </div>
        </section>
      </div>
    </div>

    <footer class="muted center" style="margin-top:16px">
      <small>Switch color to update item prices. Data loads from prices.json</small>
    </footer>

    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
